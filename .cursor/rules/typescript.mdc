---
description: TypeScript coding conventions for Snaps packages
globs: '**/*.ts,**/*.tsx'
alwaysApply: false
---

# TypeScript Conventions

## Naming Conventions

### Files

| Type         | Pattern                  | Example                              |
| ------------ | ------------------------ | ------------------------------------ |
| Controller   | `PascalCase.ts`          | `SnapController.ts`                  |
| Utility      | `lowercase.ts`           | `utils.ts`, `validation.ts`          |
| Test         | `[Name].test.ts`         | `SnapController.test.ts`             |
| Browser test | `[Name].test.browser.ts` | `IFrameSnapExecutor.test.browser.ts` |
| JSX test     | `[Name].test.tsx`        | `SnapController.test.tsx`            |

### Classes and Types

| Element          | Pattern                   | Example                                    |
| ---------------- | ------------------------- | ------------------------------------------ |
| Controller       | `[Domain]Controller`      | `SnapController`, `CronjobController`      |
| Abstract service | `Abstract[Domain]Service` | `AbstractExecutionService`                 |
| Executor         | `[Platform]SnapExecutor`  | `IFrameSnapExecutor`, `ThreadSnapExecutor` |
| Struct validator | `[Type]Struct`            | `CronjobSpecificationStruct`               |
| Props type       | `[Component]Props`        | `TextProps`, `ButtonProps`                 |
| Element type     | `[Component]Element`      | `TextElement`, `ButtonElement`             |

### Functions

| Purpose    | Pattern           | Example                        |
| ---------- | ----------------- | ------------------------------ |
| Factory    | `get[Type]Object` | `getPersistedSnapObject()`     |
| Type guard | `is[Type]`        | `isCronjobSpecification()`     |
| Creator    | `create[Thing]`   | `createSnapComponent()`        |
| Handler    | `on[Action]`      | `onTransaction`, `onSignature` |

### Variables

- Variables/functions: `camelCase`
- Types/interfaces: `PascalCase` (no `I` prefix)
- Enums: `PascalCase`, members also `PascalCase`
- Type parameters: minimum 3 characters (e.g., `Type`, `Value`, not `T`)

## Types

```typescript
// Explicit types for function params and public APIs
export function getSnap(snapId: SnapId): Snap | undefined;

// Infer types from Superstruct
type MyType = Infer<typeof MyTypeStruct>;
```

## Imports

```typescript
// Type imports separated
import type { SnapId } from '@metamask/snaps-sdk';
import { validateSnapId } from '@metamask/snaps-utils';

// Superstruct for validation
import { create, object, string } from '@metamask/superstruct';
```

## Error Handling

```typescript
import { rpcErrors, providerErrors } from '@metamask/rpc-errors';

throw rpcErrors.invalidParams({ message: 'Invalid params: ...' });
throw providerErrors.unauthorized();
```

## JSDoc

Document all exported functions:

```typescript
/**
 * Get the state of the Snap.
 *
 * @param snapId - The ID of the Snap.
 * @returns The Snap state, or null if not found.
 */
export function getSnapState(snapId: SnapId): Json | null;
```

## Controllers

- Controllers extend `BaseController`
- Must have state; stateless logic belongs in services
- Define public messenger types with actions and events
- Include `:getState` action and `:stateChange` event at minimum

```typescript
export type MyControllerActions = MyControllerGetStateAction | OtherAction;
export type MyControllerEvents = MyControllerStateChangeEvent | OtherEvent;
```
